<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<body>

<div th:fragment="transactionForm(title, subtitle, actionUrl, submitText)">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-12 col-md-8 col-lg-6">

        <div class="card border-0 shadow-sm rounded-4">
          <div class="card-header bg-white border-0 pt-4 px-4">
            <h3 class="mb-1 fw-bold" th:text="${title}">Title</h3>
            <p class="text-muted mb-0" th:text="${subtitle}">Subtitle</p>
          </div>

          <div class="card-body p-4">
            <form th:action="${actionUrl}"
                  th:object="${transaction}"
                  th:method="post"
                  class="needs-validation"
                  novalidate>

              <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

              <div th:if="${#fields.hasErrors('*')}" class="alert alert-danger mb-3">
                <ul>
                  <li th:each="err : ${#fields.errors('*')}" th:text="${err}"></li>
                </ul>
              </div>

              <!-- Amount -->
              <div class="mb-3">
                <label class="form-label fw-semibold" for="amount">Amount</label>
                <input id="amount"
                       type="number"
                       step="0.01"
                       class="form-control form-control-lg rounded-3"
                       th:field="*{amount}"
                       required>
              </div>

              <!-- Transaction Type -->
              <div class="mb-3">
                <label class="form-label fw-semibold" for="type">Transaction Type</label>
                <select id="type"
                        class="form-select form-select-lg rounded-3"
                        th:field="*{type}"
                        required>
                  <option value="" disabled>Select type</option>
                  <option th:each="t : ${types}"
                          th:value="${t}"
                          th:text="${t}">
                  </option>
                </select>
              </div>

              <!-- Date -->
              <div class="mb-3">
                <label class="form-label fw-semibold" for="date">Date</label>
                <input id="date"
                       type="datetime-local"
                       class="form-control form-control-lg rounded-3"
                       th:field="*{date}"
                       required>
              </div>

              <!-- Payment Method -->
              <div class="mb-3">
                <label class="form-label fw-semibold" for="paymentMethod">
                  Payment Method
                </label>
                <select id="paymentMethod"
                        class="form-select form-select-lg rounded-3"
                        th:field="*{paymentMethod}"
                        required>
                  <option value="" disabled>Select payment method</option>
                  <option th:each="pm : ${paymentMethods}"
                          th:value="${pm}"
                          th:text="${pm}">
                  </option>
                </select>
              </div>

              <!-- Category -->
              <div class="mb-3">
                <label class="form-label fw-semibold" for="categoryId">Category</label>
                <select id="categoryId" class="form-select form-select-lg rounded-3"
                        th:field="*{categoryId}"
                        required>
                  <option value="" disabled selected>Select category...</option>
                  <option th:each="cat : ${categories}"
                          th:value="${cat.id}"
                          th:text="${cat.name}">
                  </option>
                </select>

                <div class="invalid-feedback">
                  Please select a category.
                </div>
              </div>

              <!-- Note -->
              <div class="mb-4">
                <label class="form-label fw-semibold" for="note">Note</label>
                <textarea id="note"
                          class="form-control rounded-3"
                          rows="3"
                          th:field="*{note}">
                                </textarea>
              </div>

              <!-- Buttons -->
              <div class="d-flex gap-2 justify-content-end">
                <a th:href="@{/transactions}"
                   class="btn btn-outline-secondary btn-sm px-4 rounded-3">
                  Cancel
                </a>
                <button type="submit"
                        class="btn btn-primary btn-sm px-4 rounded-3"
                        th:text="${submitText}">
                  Submit
                </button>
              </div>
            </form>
          </div>
        </div>

        <div class="text-center mt-3 text-muted small">
          Make sure everything looks good before saving âœ¨
        </div>

      </div>
    </div>
  </div>
</div>

</body>
</html>
